package de.dis2011.data;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

import de.dis2011.data.DB2ConnectionManager;

public class Immobilie {
	private int id = -1;
	private int id_makler;
	private String ort;
	private String plz;
	private String strasse;
	private String haus_nr;
	private int flaeche;
	

	public int getId() {
		return id;
	}
	
	public void setId(int id) {
		this.id = id;
	}
	
	public int getId_makler() {
		return id_makler;
	}
	
	public void setId_makler(int id_makler) {
		this.id_makler = id_makler;
	}
	
	public String getOrt() {
		return ort;
	}
	
	public void setOrt(String ort) {
		this.ort = ort;
	}
	
	public String getPlz() {
		return plz;
	}
	
	public void setPlz(String plz) {
		this.plz = plz;
	}
	
	public String getStrasse() {
		return strasse;
	}
	
	public void setStrasse(String strasse) {
		this.strasse = strasse;
	}
	
	public String getHaus_nr() {
		return haus_nr;
	}
	
	public void setHaus_nr(String haus_nr) {
		this.haus_nr = haus_nr;
	}
	
	public int getFlaeche() {
		return flaeche;
	}
	
	public void setFlaeche(int flaeche) {
		this.flaeche = flaeche;
	}
	
	
	
	
	/**
	 * Läd eine Liste aller Makler aus der Datenbank
	 * @return Makler-Array
	 */
	public static ArrayList<Vertrag> load_all_immobilien() {
		try	{
			// Hole Verbindung
			Connection con = DB2ConnectionManager.getInstance().getConnection();
			
			// Erzeuge Anfrage
			String selectSQL = "SELECT id, strasse, haus_nr,  FROM immobilien";
			PreparedStatement pstmt = con.prepareStatement(selectSQL);
			
			// Führe Anfrage aus
			ResultSet rs = pstmt.executeQuery();
			
			// Liste für alle Verträge (mit id)
			ArrayList<Vertrag> all_vertraege = new ArrayList<Vertrag>();
			
			while(rs.next()){
				Vertrag ts = new Vertrag();
				ts.setId(rs.getInt("id"));
				ts.setVertragsnummer(rs.getString("vertragsnr"));
				
				all_vertraege.add(ts);

			}
			
			rs.close();
			pstmt.close();
			return all_vertraege;

		} catch (SQLException e) {
			e.printStackTrace();
		}
		return null;
	}
}
