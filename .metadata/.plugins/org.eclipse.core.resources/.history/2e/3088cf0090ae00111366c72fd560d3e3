package de.dis2012.core.log;

import java.util.Hashtable;

public class Puffer {
	Hashtable<Integer, Logdatensatz> puffer = new Hashtable<Integer, Logdatensatz>();
	int status;
	
	public Puffer(){
		// initialisiert, dass Daten in den Puffer geschrieben werden können
		this.status = 1;
	}

	public Hashtable<Integer, Logdatensatz> getPuffer() {
		return puffer;
	}

	public void setPuffer(Hashtable<Integer, Logdatensatz> puffer) {
		this.puffer = puffer;
	}

	/**
	 * putInPuffer
	 * 
	 * schriebt in den Puffer einen Logdatensatz und gibt eine 1 zurück, 
	 * falls noch platz für weitere ist
	 * @param logdatensatz
	 * @return int 1: Zeigt an, noch platz bestand und der Datensatz eingefügt werden konnte
	 * @return int 0: Zeigt an, dass kein weiterer platz für Logdatensätze besteht
	 */
	public int putInPuffer(Logdatensatz logdatensatz) {		
		System.err.println(puffer.size());
		if(puffer.size() < 5) {
			puffer.put(logdatensatz.getPageId(), logdatensatz);
			System.out.println("Log mit PageId " + logdatensatz.getPageId() + " wurde geschrieben");
			
			// gibt zurück, dass noch platz zum einfügen war
			status = 1;
		}else{
			System.err.println("Log ist voll");
			
			// gibt zurück, dass keine weiteren Logdatensätze gecshrieben werden können
			this.status = 0;
		}
		
		return this.status;
	}



	
}
